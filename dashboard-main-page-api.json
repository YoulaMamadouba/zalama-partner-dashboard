{
  "page": "Dashboard Principal",
  "file": "app/dashboard/page.tsx",
  "description": "Spécifications API pour la page dashboard principale - Vue d'ensemble avec statistiques et graphiques",
  "baseUrl": "https://admin.zalamagn.com/api",
  "endpoints": {
    "main": {
      "method": "GET",
      "path": "/dashboard/main",
      "description": "Données principales du dashboard avec toutes les statistiques et calculs",
      "headers": {
        "Authorization": "Bearer {token}"
      },
      "response": {
        "success": {
          "employees": [
            {
              "id": "string",
              "partner_id": "string",
              "nom": "string",
              "prenom": "string",
              "genre": "string",
              "email": "string",
              "telephone": "string",
              "adresse": "string",
              "poste": "string",
              "type_contrat": "string",
              "salaire_net": "number",
              "date_embauche": "string (ISO date)",
              "actif": "boolean",
              "created_at": "string (ISO date)",
              "updated_at": "string (ISO date)"
            }
          ],
          "transactions": [
            {
              "transaction_id": "number",
              "montant": "number",
              "type": "string",
              "description": "string",
              "partenaire_id": "string",
              "utilisateur_id": "string",
              "service_id": "number",
              "statut": "string",
              "date_transaction": "string (ISO date)",
              "date_validation": "string (ISO date)",
              "reference": "string"
            }
          ],
          "allTransactions": [
            {
              "id": "string",
              "montant": "number",
              "statut": "string",
              "created_at": "string (ISO date)",
              "entreprise_id": "string"
            }
          ],
          "alerts": [
            {
              "id": "string",
              "titre": "string",
              "description": "string",
              "type": "string",
              "statut": "string",
              "date_creation": "string (ISO date)",
              "priorite": "number"
            }
          ],
          "avis": [
            {
              "id": "string",
              "employee_id": "string",
              "partner_id": "string",
              "note": "number",
              "commentaire": "string",
              "type_retour": "string",
              "date_avis": "string (ISO date)",
              "approuve": "boolean"
            }
          ],
          "demandes": [
            {
              "id": "string",
              "employe_id": "string",
              "partenaire_id": "string",
              "montant_demande": "number",
              "type_motif": "string",
              "motif": "string",
              "frais_service": "number",
              "montant_total": "number",
              "statut": "string",
              "date_creation": "string (ISO date)",
              "date_validation": "string (ISO date)"
            }
          ],
          "salaryRequests": [
            {
              "id": "string",
              "montant_demande": "number",
              "statut": "string",
              "date_validation": "string (ISO date)",
              "partenaire_id": "string"
            }
          ],
          "paymentDay": "number",
          "stats": {
            "total_employees": "number",
            "total_transactions": "number",
            "total_alerts": "number",
            "total_avis": "number",
            "total_demandes": "number",
            "totalAmount": "number",
            "pendingDemandes": "number",
            "positiveAvis": "number",
            "averageRating": "number"
          },
          "calculs": {
            "activeEmployees": "number",
            "totalSalary": "number",
            "fluxFinance": "number",
            "debloqueMois": "number",
            "aRembourserMois": "number",
            "employesApprouves": "number",
            "totalRecupere": "number",
            "totalRevenus": "number",
            "totalRemboursements": "number",
            "totalCommissions": "number",
            "balance": "number",
            "activeAlerts": "number",
            "pendingDemandes": "number",
            "dateLimite": "string",
            "joursRestants": "string"
          },
          "graphiques": {
            "demandesEvolutionData": [
              {
                "mois": "string",
                "demandes": "number"
              }
            ],
            "montantsEvolutionData": [
              {
                "mois": "string",
                "montant": "number"
              }
            ],
            "repartitionMotifsData": [
              {
                "motif": "string",
                "valeur": "number",
                "color": "string"
              }
            ]
          }
        },
        "error": {
          "message": "string"
        }
      }
    },
    "stats": {
      "method": "GET",
      "path": "/dashboard/stats",
      "description": "Statistiques détaillées du dashboard",
      "headers": {
        "Authorization": "Bearer {token}"
      },
      "response": {
        "success": {
          "totalEmployees": "number",
          "totalTransactions": "number",
          "totalAlerts": "number",
          "totalAvis": "number",
          "totalDemandes": "number",
          "totalAmount": "number",
          "pendingDemandes": "number",
          "positiveAvis": "number",
          "averageRating": "number"
        },
        "error": {
          "message": "string"
        }
      }
    },
    "partnership": {
      "method": "GET",
      "path": "/partnership/payment-day",
      "description": "Récupérer le payment_day du partenaire",
      "headers": {
        "Authorization": "Bearer {token}"
      },
      "response": {
        "success": {
          "payment_day": "number"
        },
        "error": {
          "message": "string"
        }
      }
    }
  },
  "services": {
    "PartnerDataService": {
      "getEmployees": "Récupère la liste des employés du partenaire",
      "getFinancialTransactions": "Récupère les transactions financières",
      "getAlerts": "Récupère les alertes du partenaire",
      "getAvis": "Récupère les avis des employés",
      "getSalaryAdvanceRequests": "Récupère les demandes d'avance de salaire",
      "getPartnerStats": "Récupère les statistiques calculées du partenaire"
    }
  },
  "databaseQueries": {
    "employees": {
      "table": "employees",
      "query": "SELECT * FROM employees WHERE partner_id = ? ORDER BY created_at DESC",
      "filters": {
        "partner_id": "string (UUID)"
      }
    },
    "transactions": {
      "table": "financial_transactions",
      "query": "SELECT * FROM financial_transactions WHERE partenaire_id = ? AND statut = 'Validé'",
      "filters": {
        "partenaire_id": "string (UUID)",
        "statut": "Validé"
      }
    },
    "allTransactions": {
      "table": "transactions",
      "query": "SELECT * FROM transactions WHERE entreprise_id = ? AND statut = 'EFFECTUEE'",
      "filters": {
        "entreprise_id": "string (UUID)",
        "statut": "EFFECTUEE"
      }
    },
    "alerts": {
      "table": "alerts",
      "query": "SELECT * FROM alerts WHERE partenaire_id = ? ORDER BY date_creation DESC",
      "filters": {
        "partenaire_id": "string (UUID)"
      }
    },
    "avis": {
      "table": "avis",
      "query": "SELECT * FROM avis WHERE partner_id = ? ORDER BY date_avis DESC",
      "filters": {
        "partner_id": "string (UUID)"
      }
    },
    "demandes": {
      "table": "salary_advance_requests",
      "query": "SELECT * FROM salary_advance_requests WHERE partenaire_id = ? AND statut = 'Validé'",
      "filters": {
        "partenaire_id": "string (UUID)",
        "statut": "Validé"
      }
    },
    "partnership": {
      "table": "partnership_requests",
      "query": "SELECT payment_day FROM partnership_requests WHERE company_name = ? AND status = 'approved'",
      "filters": {
        "company_name": "string",
        "status": "approved"
      }
    }
  },
  "calculs": {
    "activeEmployees": "employees.filter(emp => emp.actif).length",
    "totalSalary": "activeEmployees.reduce((sum, emp) => sum + (emp.salaire_net || 0), 0)",
    "fluxFinance": "allTransactions.reduce((sum, t) => sum + Number(t.montant || 0), 0)",
    "debloqueMois": "allTransactions.reduce((sum, t) => sum + Number(t.montant || 0), 0)",
    "aRembourserMois": "debloqueMois",
    "employesApprouves": "demandesMois.length",
    "totalRecupere": "transactions.filter(t => t.type === 'Récupéré' && t.statut === 'Validé').reduce((sum, t) => sum + (t.montant || 0), 0)",
    "totalRevenus": "transactions.filter(t => t.type === 'Revenu' && t.statut === 'Validé').reduce((sum, t) => sum + (t.montant || 0), 0)",
    "totalRemboursements": "transactions.filter(t => t.type === 'Remboursement' && t.statut === 'Validé').reduce((sum, t) => sum + (t.montant || 0), 0)",
    "totalCommissions": "transactions.filter(t => t.type === 'Commission' && t.statut === 'Validé').reduce((sum, t) => sum + (t.montant || 0), 0)",
    "balance": "totalRecupere - totalRemboursements + totalRevenus",
    "activeAlerts": "alerts.filter(alert => alert.statut !== 'Résolue').length",
    "averageRating": "avis.length > 0 ? avis.reduce((sum, av) => sum + av.note, 0) / avis.length : 0",
    "pendingDemandes": "demandes.filter(dem => dem.statut === 'En attente').length",
    "dateLimite": "Calcul basé sur paymentDay",
    "joursRestants": "Calcul basé sur dateLimite"
  },
  "graphiques": {
    "demandesEvolutionData": {
      "description": "Évolution des demandes sur 6 derniers mois",
      "calcul": "Grouper les demandes par mois et compter",
      "structure": [
        {
          "mois": "string (Jan, Fév, Mar, etc.)",
          "demandes": "number"
        }
      ]
    },
    "montantsEvolutionData": {
      "description": "Évolution des montants débloqués sur 6 derniers mois",
      "calcul": "Grouper les transactions par mois et sommer les montants",
      "structure": [
        {
          "mois": "string (Jan, Fév, Mar, etc.)",
          "montant": "number"
        }
      ]
    },
    "repartitionMotifsData": {
      "description": "Répartition des demandes par motif",
      "calcul": "Compter les demandes par type_motif",
      "structure": [
        {
          "motif": "string",
          "valeur": "number",
          "color": "string (couleur hex)"
        }
      ]
    }
  },
  "dataTypes": {
    "Employee": {
      "id": "string (UUID)",
      "partner_id": "string (UUID)",
      "nom": "string",
      "prenom": "string",
      "genre": "'Homme' | 'Femme' | 'Autre'",
      "email": "string (optionnel)",
      "telephone": "string (optionnel)",
      "adresse": "string (optionnel)",
      "poste": "string",
      "type_contrat": "'CDI' | 'CDD' | 'Consultant' | 'Stage' | 'Autre'",
      "salaire_net": "number (optionnel)",
      "date_embauche": "string (ISO date, optionnel)",
      "actif": "boolean",
      "created_at": "string (ISO date)",
      "updated_at": "string (ISO date)"
    },
    "FinancialTransaction": {
      "transaction_id": "number",
      "montant": "number",
      "type": "string",
      "description": "string (optionnel)",
      "partenaire_id": "string (optionnel)",
      "utilisateur_id": "string (optionnel)",
      "service_id": "number (optionnel)",
      "statut": "string",
      "date_transaction": "string (ISO date)",
      "date_validation": "string (ISO date, optionnel)",
      "reference": "string (optionnel)"
    },
    "Transaction": {
      "id": "string (UUID)",
      "montant": "number",
      "statut": "string",
      "created_at": "string (ISO date)",
      "entreprise_id": "string (UUID)"
    },
    "Alert": {
      "id": "string (UUID)",
      "titre": "string",
      "description": "string (optionnel)",
      "type": "'Critique' | 'Importante' | 'Information'",
      "statut": "'Résolue' | 'En cours' | 'Nouvelle'",
      "date_creation": "string (ISO date)",
      "priorite": "number"
    },
    "Avis": {
      "id": "string (UUID)",
      "employee_id": "string (UUID)",
      "partner_id": "string (UUID)",
      "note": "number",
      "commentaire": "string (optionnel)",
      "type_retour": "'positif' | 'negatif'",
      "date_avis": "string (ISO date)",
      "approuve": "boolean"
    },
    "SalaryAdvanceRequest": {
      "id": "string (UUID)",
      "employe_id": "string (UUID)",
      "partenaire_id": "string (UUID)",
      "montant_demande": "number",
      "type_motif": "string",
      "motif": "string",
      "frais_service": "number",
      "montant_total": "number",
      "statut": "string",
      "date_creation": "string (ISO date)",
      "date_validation": "string (ISO date, optionnel)"
    }
  },
  "databaseTables": {
    "employees": "Table des employés des partenaires",
    "financial_transactions": "Table des transactions financières",
    "transactions": "Table des transactions (pour finances)",
    "alerts": "Table des alertes système",
    "avis": "Table des avis des employés",
    "salary_advance_requests": "Table des demandes d'avance de salaire",
    "partnership_requests": "Table des demandes de partenariat"
  },
  "errorCodes": {
    "400": "Bad Request - Données invalides",
    "401": "Unauthorized - Token invalide ou expiré",
    "403": "Forbidden - Accès refusé",
    "404": "Not Found - Ressource non trouvée",
    "422": "Unprocessable Entity - Erreur de validation",
    "500": "Internal Server Error - Erreur serveur"
  }
}
